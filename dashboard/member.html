<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Genel Bakış | Teknoify</title>

  <link href="https://fonts.googleapis.com/css2?family=Inter+Tight:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="stylesheet" href="../css/dashboard.css?v=9">

  <style>
    /* ==========================================================================
       ULTRA-PROFESSIONAL QUANTUM CUBE LOADER (TEKNOIFY EXCLUSIVE)
       ========================================================================== */
    #loading-overlay {
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      background: #05080a; /* Daha derin, tamamen siyahımsı mavi */
      z-index: 9999;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      overflow: hidden;
      transition: opacity 0.8s cubic-bezier(0.4, 0, 0.2, 1), visibility 0.8s;
    }

    /* Arka Plan Digital Grid Efekti */
    #loading-overlay::before {
      content: "";
      position: absolute;
      width: 200%; height: 200%;
      background-image: 
        linear-gradient(rgba(99, 102, 241, 0.05) 1px, transparent 1px),
        linear-gradient(90deg, rgba(99, 102, 241, 0.05) 1px, transparent 1px);
      background-size: 50px 50px;
      transform: perspective(500px) rotateX(60deg) translateY(-10%);
      animation: gridMove 15s linear infinite;
      z-index: 1;
    }

    @keyframes gridMove {
      0% { transform: perspective(500px) rotateX(60deg) translateY(0); }
      100% { transform: perspective(500px) rotateX(60deg) translateY(50px); }
    }

    /* Holografik Daireler */
    .hologram-ring {
      position: absolute;
      border: 1px solid rgba(99, 102, 241, 0.2);
      border-radius: 50%;
      animation: ringRotate 10s linear infinite;
      z-index: 2;
    }
    .ring-1 { width: 300px; height: 300px; border-style: dashed; }
    .ring-2 { width: 400px; height: 400px; animation-direction: reverse; opacity: 0.5; }

    @keyframes ringRotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

    /* 3D Küp Sahnesi */
    .cube-container {
      width: 120px; height: 120px;
      perspective: 1000px;
      z-index: 10;
      position: relative;
    }

    .cube-main {
      width: 100%; height: 100%;
      position: relative;
      transform-style: preserve-3d;
      animation: complexRotate 6s infinite ease-in-out;
    }

    /* Küp Yüzeyleri - Cam Efekti */
    .face {
      position: absolute;
      width: 120px; height: 120px;
      background: rgba(99, 102, 241, 0.03);
      border: 1px solid rgba(99, 102, 241, 0.6);
      box-shadow: 0 0 20px rgba(99, 102, 241, 0.2) inset;
      backdrop-filter: blur(2px);
    }

    .front  { transform: translateZ(60px); }
    .back   { transform: rotateY(180deg) translateZ(60px); }
    .right  { transform: rotateY(90deg) translateZ(60px); }
    .left   { transform: rotateY(-90deg) translateZ(60px); }
    .top    { transform: rotateX(90deg) translateZ(60px); }
    .bottom { transform: rotateX(-90deg) translateZ(60px); }

    /* İç Enerji Çekirdeği (Core) */
    .cube-core {
      position: absolute;
      top: 50%; left: 50%;
      width: 40px; height: 40px;
      margin: -20px;
      background: #6366f1;
      box-shadow: 0 0 40px #6366f1;
      border-radius: 4px;
      animation: corePulse 2s infinite alternate ease-in-out;
      transform-style: preserve-3d;
    }

    @keyframes complexRotate {
      0% { transform: rotateX(0deg) rotateY(0deg) scale(1); }
      33% { transform: rotateX(180deg) rotateY(90deg) scale(1.1); }
      66% { transform: rotateX(360deg) rotateY(270deg) scale(0.9); }
      100% { transform: rotateX(720deg) rotateY(360deg) scale(1); }
    }

    @keyframes corePulse {
      0% { transform: scale(0.8) rotateY(0); opacity: 0.5; }
      100% { transform: scale(1.2) rotateY(360deg); opacity: 1; }
    }

    /* Veri Akış Yazıları */
    .data-loader-info {
      margin-top: 60px;
      text-align: center;
      z-index: 10;
      font-family: 'Fira Code', monospace;
    }

    .main-status {
      font-size: 16px;
      color: #fff;
      font-weight: 700;
      letter-spacing: 5px;
      text-transform: uppercase;
      margin-bottom: 10px;
      text-shadow: 0 0 10px rgba(99, 102, 241, 0.8);
    }

    .sub-status {
      font-size: 11px;
      color: #6366f1;
      opacity: 0.8;
    }

    /* Terminal Benzeri Akan Yazılar */
    .terminal-logs {
      position: absolute;
      bottom: 40px;
      left: 40px;
      font-family: 'Fira Code', monospace;
      font-size: 10px;
      color: rgba(99, 102, 241, 0.4);
      pointer-events: none;
    }

    /* Sidebar başlık stili */
    .tk-nav-section {
      margin-top:10px; margin-bottom:5px; padding-left:16px;
      font-size:0.75rem; color:#666; font-weight:700; text-transform:uppercase;
    }
  </style>

  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>

<body>

  <div id="loading-overlay">
    <div class="hologram-ring ring-1"></div>
    <div class="hologram-ring ring-2"></div>
    
    <div class="cube-container">
      <div class="cube-main">
        <div class="face front"></div>
        <div class="face back"></div>
        <div class="face right"></div>
        <div class="face left"></div>
        <div class="face top"></div>
        <div class="face bottom"></div>
        <div class="cube-core"></div>
      </div>
    </div>

    <div class="data-loader-info">
      <div class="main-status">Sistem Yükleniyor</div>
      <div class="sub-status" id="dynamic-loader-text">Güvenli oturum başlatılıyor...</div>
    </div>

    <div class="terminal-logs" id="terminal-logs">
      <div>> INITIALIZING CORE_SYSTEM... OK</div>
      <div>> ESTABLISHING SECURE_LINK... OK</div>
      <div>> FETCHING ENCRYPTED_DATA... WAITING</div>
    </div>
  </div>

  <button id="floating-toggle-btn" onclick="toggleSidebar()"><i class="fas fa-bars"></i></button>

  <aside class="sidebar">
    <div class="brand"><i class="fas fa-cube"></i> <span>Teknoify</span></div>
    <nav id="tk-sidebar-nav">
      <a href="/dashboard/member.html" class="menu-item active"><i class="fas fa-home"></i> <span>Genel Bakış</span></a>
      <div class="tk-nav-section"><span>Hizmetler</span></div>
      <div id="dynamic-services-menu"></div>
    </nav>
    <div class="menu-spacer"></div>
    <div class="sidebar-footer">
      <a href="#" onclick="logout()" class="btn-logout"><i class="fas fa-sign-out-alt"></i> <span>Çıkış</span></a>
      <button class="btn-collapse" onclick="toggleSidebar()"><i class="fas fa-chevron-left"></i></button>
    </div>
  </aside>

  <main class="main-content">
    <header class="top-bar">
      <h2>Hoşgeldin, <span id="user-name-title">...</span></h2>
      <div class="user-profile">
        <span id="user-name-display">Yükleniyor...</span>
        <div class="avatar" id="user-avatar">U</div>
      </div>
    </header>

    <div class="content-scroll">
      <div class="stats-grid">
        <div class="stat-card"><div class="stat-title">Aktif Hizmetler</div><div class="stat-value" id="stat-active-services">1</div></div>
        <div class="stat-card"><div class="stat-title">İşlenen Veri</div><div class="stat-value" id="processed-data-count">-</div></div>
        <div class="stat-card"><div class="stat-title">Kazanılan Saat</div><div class="stat-value" id="stat-saved-hours">-</div></div>
        <div class="stat-card"><div class="stat-title">Sonraki Ödeme</div><div class="stat-value" id="stat-next-payment">-</div></div>
      </div>
      </div>
  </main>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
  <script src="../config.js"></script>
  <script src="./shared/auth.js?v=20260228"></script>
  <script type="module" src="../js/pages/member.js?v=20260228"></script>

  <script>
    // Dinamik Yükleme Metinleri ve Terminal Simülasyonu
    const statusTexts = [
      "Profil verileri doğrulanıyor...",
      "Güvenlik katmanı aktif ediliyor...",
      "Şifrelenmiş tünel kuruluyor...",
      "Modüller senkronize ediliyor...",
      "Veritabanı bağlantısı kuruluyor...",
      "Arayüz render ediliyor..."
    ];
    
    let textIdx = 0;
    const textEl = document.getElementById("dynamic-loader-text");
    const terminalEl = document.getElementById("terminal-logs");

    const textInterval = setInterval(() => {
      textEl.style.opacity = "0";
      setTimeout(() => {
        textEl.textContent = statusTexts[textIdx];
        textEl.style.opacity = "1";
        textIdx = (textIdx + 1) % statusTexts.length;
      }, 300);

      // Rastgele terminal logu ekleme
      const log = document.createElement("div");
      log.textContent = `> SYNC_DATA_CHUNK_${Math.floor(Math.random()*9999)}... OK`;
      terminalEl.appendChild(log);
      if(terminalEl.children.length > 5) terminalEl.removeChild(terminalEl.firstChild);
    }, 1500);

    // Overlay'i Kapatma Mantığı
    (function () {
      const overlay = document.getElementById("loading-overlay");
      function tryHide() {
        if (window.USER_SESSION && overlay) {
          clearInterval(textInterval);
          overlay.style.opacity = "0";
          overlay.style.visibility = "hidden";
          setTimeout(() => overlay.remove(), 800);
          const t = document.getElementById("user-name-title");
          if (t && window.USER_SESSION.name) t.textContent = window.USER_SESSION.name;
          return true;
        }
        return false;
      }
      if (!tryHide()) {
        const iv = setInterval(() => { if (tryHide()) clearInterval(iv); }, 120);
        setTimeout(() => clearInterval(iv), 10000);
      }
    })();
  </script>
</body>
</html>
